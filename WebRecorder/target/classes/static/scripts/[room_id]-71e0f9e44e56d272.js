(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[996],{4751:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/obs/[room_id]",function(){return n(9994)}])},4254:function(e,t,n){"use strict";n.d(t,{Z:function(){return _}});var s=n(1527),i=n(2803),r=n.n(i),c=n(959),l=n(468),a=n(5999),o=n(5341),u=n(7083),f=n(2970),d=n(3290),p=n(5484),h=n(4632),m=n(9049),g=n.n(m);function _(e){let{predefinedEvents:t,scrollable:n=!1,rooms:i,className:m,..._}=e,v=(0,c.useRef)(null),b=(0,c.useRef)(0),[x,E]=(0,c.useState)([]),[j,y]=(0,c.useState)([]),[N,L]=(0,c.useState)(!0),[Z,k]=(0,c.useState)(0),{events:S,queue:w,addEvent:O,delQueue:T,updateRemoteEmotes:C}=(0,f.Z)(),z=(0,p.D)(),{colorScheme:B,sceneName:P,showStickyBar:R,sortStickyBarByPrice:W,showGiftStickyAbove:D,showGiftStickyAlways:X,limitEventAmount:A}=z,{remoteEmotes:F}=(0,h.Z)(i);return(0,c.useEffect)(()=>{F&&C(F)},[F,C]),(0,c.useEffect)(()=>{let e=t&&t.length>0,s=e?t:S;if(s&&s.length>0){E(s.slice(-1*(A||50)));let e=s.filter(e=>("gift"===e.type&&"gold"===e.coinType||"superchat"===e.type||"toast"===e.type||"mvp"===e.type)&&e.priceNormalized>D&&(X||n||e.timestampNormalized+1e3*e.duration>=Date.now())).slice(-20);y(W?e.sort((e,t)=>t.priceNormalized-e.priceNormalized):e.reverse())}},[t,S,D,W,X,A,n]),(0,c.useEffect)(()=>{if(w.length>0){let e=w.length,t=e>60||Z>60?0:1200/e,n=setTimeout(()=>{let e=w[0];if(N){let t=(0,d.Z)(e,z);t&&O(e),T(1)}},t);return()=>clearTimeout(n)}},[w,O,T,N,z,Z]),(0,c.useEffect)(()=>{setTimeout(()=>{b.current=S.length},1e3)},[S]),(0,c.useEffect)(()=>{S&&S.length>0&&k(S.length-b.current)},[b,S]),(0,c.useEffect)(()=>{x&&x.length>0&&!n&&v.current&&v.current.scrollTo({top:v.current.scrollHeight,behavior:Z>3?"auto":"smooth"})},[n,x,Z]),(0,s.jsx)(s.Fragment,{children:x&&x.length>0&&(0,s.jsxs)("div",{..._,className:"jsx-f4194df4d9b7b81 "+(_&&null!=_.className&&_.className||(0,o.Z)(g().eventListWrap,"event-list-wrap",B&&"scheme-".concat(B),P&&"scene-".concat(P),m)||""),children:[(0,s.jsx)(r(),{id:"f4194df4d9b7b81",children:"body{background-color:transparent}"}),R&&j&&j.length>0&&(0,s.jsx)(a.U5,{className:(0,o.Z)(g().giftStickyBar,n&&g().scrollable,"gift-sticky-bar slim-scrollbar"),flipKey:j,spring:{stiffness:1e3,damping:100},children:j.map((e,t)=>(0,s.jsx)(a.$3,{flipId:"".concat(e.id),children:(0,s.jsx)(u.Z,{data:e,as:"sticky"},"".concat(e.id))},"".concat(e.id)))}),(0,s.jsx)(l.x,{viewportRef:v,type:n?"hover":"never",className:(0,o.Z)(g().eventList,"event-list",n&&g().scrollable),onScrollPositionChange:n?()=>{if(v.current){let{scrollTop:e,scrollHeight:t,offsetHeight:n}=v.current;L(e+n>=t-250)}}:void 0,children:x.map((e,t)=>(0,s.jsx)(u.Z,{data:e},"".concat(e.id)))})]})})}},9994:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var s=n(1527),i=n(959),r=n(2309),c=n.n(r),l=n(4373),a=n(4254),o=n(4756),u=n(4679);function f(){let e=(0,l.useRouter)(),{isReady:t,query:n}=e,{room_id:r}=n,[f,d]=(0,i.useState)([]);return(0,i.useEffect)(()=>{if(t&&"string"==typeof r){let e=r.split(",").map(e=>parseInt(e));d(e),(0,u.Z)([...e])}},[t,r]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c(),{children:(0,s.jsx)("title",{children:"LAPLACE Chat OBS Widget"})}),(0,s.jsx)(o.Z,{}),(0,s.jsx)("main",{children:(0,s.jsx)(a.Z,{rooms:f})})]})}},9049:function(e){e.exports={eventListWrap:"EventListObs_eventListWrap__Gak7x",eventList:"EventListObs_eventList__SwLvb",scrollable:"EventListObs_scrollable__hncGH",giftStickyBar:"EventListObs_giftStickyBar__DvXOZ"}}},function(e){e.O(0,[980,58,972,774,888,179],function(){return e(e.s=4751)}),_N_E=e.O()}]);